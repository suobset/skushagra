{{ define "main" }}
{{ partial "header" . }}

<section>
  <h2 class="section-title">Posts<span class="cursor"></span></h2>
  
  {{ $paginator := .Paginate (where .Site.RegularPages "Section" "posts") }}
  
  <ul class="post-list">
    {{ range $paginator.Pages }}
    <li class="post-item">
      <span class="post-date">{{ .Date.Format "Jan 02, 2006" }}</span>
      <a href="{{ .Permalink }}" class="post-link">{{ .Title }}</a>
    </li>
    {{ end }}
  </ul>
  
  {{ if gt $paginator.TotalPages 1 }}
  <nav class="pagination">
    {{ if $paginator.HasPrev }}
    <a href="{{ $paginator.Prev.URL }}" class="pagination-arrow">←</a>
    {{ else }}
    <span class="pagination-arrow disabled">←</span>
    {{ end }}
    
    <span class="pagination-text">Page</span>
    <input 
      type="number" 
      class="pagination-input" 
      value="{{ $paginator.PageNumber }}" 
      min="1" 
      max="{{ $paginator.TotalPages }}"
      data-base-url="{{ $paginator.First.URL }}"
      onchange="goToPage(this)"
    >
    <span class="pagination-text">of {{ $paginator.TotalPages }}</span>
    
    {{ if $paginator.HasNext }}
    <a href="{{ $paginator.Next.URL }}" class="pagination-arrow">→</a>
    {{ else }}
    <span class="pagination-arrow disabled">→</span>
    {{ end }}
  </nav>
  
  <script>
    function goToPage(input) {
      const page = parseInt(input.value);
      const max = parseInt(input.max);
      if (page >= 1 && page <= max) {
        const baseUrl = input.dataset.baseUrl;
        if (page === 1) {
          window.location.href = baseUrl;
        } else {
          // Hugo pagination URL pattern: /page/2/, /page/3/, etc.
          const url = baseUrl.replace(/\/$/, '') + '/page/' + page + '/';
          window.location.href = url;
        }
      }
    }
  </script>
  {{ end }}
</section>
{{ end }}